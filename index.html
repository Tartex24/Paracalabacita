<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Jennifer & Carlos | Colecci√≥n de Amor</title>
  <meta name="description" content="Una experiencia premium con nuestros recuerdos, canciones y cartas de amor." />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Montserrat:wght@300;400;500;600;700&display=swap"
    rel="stylesheet"
  />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="estilos.css" />
</head>
<body>
  <div class="bg-lights" aria-hidden="true">
    <span></span><span></span><span></span><span></span><span></span>
  </div>

  <audio id="audio-principal" loop>
    <!-- Cambia este archivo para tu m√∫sica de fondo principal -->
    <source src="musica/cancion-principal.mp3" type="audio/mpeg" />
  </audio>

  <header class="topbar">
    <div class="brand">
      <span class="brand-dot"></span>
      JENNIFER & CARLOS
    </div>
    <nav class="top-actions" aria-label="Controles principales">
      <button id="btn-audio" class="icon-btn" title="Activar o pausar m√∫sica">
        <i class="fa-solid fa-music"></i>
      </button>
      <button id="btn-carta" class="icon-btn" title="Abrir carta principal üíå" aria-label="Abrir carta principal üíå">
        üíå
      </button>
    </nav>
  </header>

  <main>
    <section id="vista-inicio" class="hero">
      <p class="eyebrow">Edici√≥n Limitada ‚Ä¢ Para el amor de mi vida</p>
      <h1>Colecci√≥n Exclusiva: Nuestro Amor</h1>
      <p class="hero-copy">
        Esta no es una p√°gina. Es un viaje por todo lo que hemos vivido, sentido y so√±ado juntos.
        Cada foto guarda una historia, cada canci√≥n revive un momento, y cada palabra lleva tu nombre.
      </p>
      <div class="hero-actions">
        <button id="btn-iniciar" class="btn btn-primary">Entrar al Cat√°logo</button>
        <button id="btn-sorpresa" class="btn btn-ghost">Ver Mensaje Especial</button>
      </div>
      <div class="hero-stats">
        <article>
          <span id="total-recuerdos">25</span>
          <small>Recuerdos √∫nicos</small>
        </article>
        <article>
          <span id="total-canciones">25</span>
          <small>Canciones de nosotros</small>
        </article>
        <article>
          <span>‚àû</span>
          <small>Razones para amarte</small>
        </article>
      </div>
    </section>

    <section class="story-panel">
      <h2>Nuestra Historia</h2>
      <p>
        Jennifer, este espacio es para ti. Quise reunir aqu√≠ nuestros recuerdos como una joya, as√≠ como algo precioso que se cuida y se admira,
        cada detalle pensado con amor, para que al abrir cada foto vuelvas a sentir ese instante, esas emociones, todo el entorno que sentimos cuando pas√≥ eso.
        No importa cu√°nto pase, siempre elegir√≠a escribir esta historia que estoy viviendo contigo una y mil veces.
      </p>
      <p class="signature">Con amor eterno, Carlos.</p>
    </section>

    <section id="vista-catalogo" class="catalogo" hidden>
      <div class="catalogo-head">
        <div>
          <p class="eyebrow">Aqu√≠ empieza tu recorrido</p>
          <h2>Nuestros Recuerdos</h2>
        </div>
        <div class="search-wrap">
          <i class="fa-solid fa-magnifying-glass"></i>
          <input id="buscador" type="search" placeholder="Buscar por t√≠tulo o fecha..." aria-label="Buscar recuerdos" />
        </div>
      </div>
      <div id="catalogo-grid" class="catalogo-grid"></div>
    </section>
  </main>

  <div id="modal-detalle" class="modal" aria-hidden="true" role="dialog" aria-labelledby="modal-titulo">
    <div class="modal-card">
      <button class="close-btn" aria-label="Cerrar detalle">
        <i class="fa-solid fa-xmark"></i>
      </button>
      <div class="modal-grid">
        <figure class="modal-visual">
          <img id="modal-img" src="" alt="Recuerdo" />
          <figcaption id="modal-fecha">Fecha del recuerdo</figcaption>
        </figure>
        <section class="modal-info">
          <h3 id="modal-titulo">T√≠tulo</h3>
          <div class="chip-row">
            <span class="chip"><i class="fa-solid fa-heart"></i> Invaluable</span>
            <span id="modal-id" class="chip">Recuerdo #1</span>
          </div>
          <p id="modal-desc"></p>

          <div class="mini-block">
            <h4><i class="fa-solid fa-music"></i> Canci√≥n del momento</h4>
            <p id="modal-cancion-nombre">Nombre de canci√≥n</p>
            <audio id="audio-especifico" controls preload="none">
              <source src="" type="audio/mpeg" />
            </audio>
          </div>

          <div class="mini-block">
            <h4><i class="fa-solid fa-pen-nib"></i> Carta / Letra</h4>
            <blockquote id="modal-letra"></blockquote>
          </div>

          <button class="btn btn-primary btn-love">Te Amo, Jennifer ‚ù§Ô∏è</button>
        </section>
      </div>
    </div>
  </div>

  <div id="modal-carta" class="modal" aria-hidden="true" role="dialog" aria-labelledby="carta-titulo">
    <div class="modal-card carta-card">
      <button class="close-btn close-carta" aria-label="Cerrar carta">
        <i class="fa-solid fa-xmark"></i>
      </button>
      <h3 id="carta-titulo">Cartita para calabacita</h3>
      <p>
        Amor, cuando hice esta p√°gina pens√© en todo lo que significas para m√≠.
        No quer√≠a solo mostrar fotos; quer√≠a que sintieras cu√°nto te admiro, cu√°nto te valoro y
        lo feliz que soy de tenerte en mi vida.
      </p>
      <p>
        Gracias por estar en mis d√≠as buenos y en los dif√≠ciles. Gracias por tu forma de amar.
        Mi promesa es seguir construyendo recuerdos hermosos contigo, hoy y siempre.
      </p>
      <p class="signature">Tu osito üêª üíå</p>
    </div>
  </div>

  <script>
const baseDeDatos = [
  {
    id: 1,
    titulo: "Nuestra primer foto juntos",
    fecha: "28/09/2023 - Un d√≠a nost√°lgico en el que se nos ocurri√≥ tomarnos una foto",
    imagen: "imagenes/foto1.jpg",
    descripcion: "Pues, empecemos por el principio, nuestra primer foto juntos, a√∫n recuerdo ese d√≠a cuando se despidieron de nosotros como promoci√≥n, recuerdo como de la nada se nos ocurri√≥ tomarnos una foto, t√∫ solo te secaste las l√°grimas y yo intent√© peinarme y ni eso consegu√≠, me gusta saber que nuestra primer foto es tan desordenada como nosotros.",
    cancionRuta: "musica-cancion-recuerdo1.mp3",
    cancionNombre: "ESENCIA",
    letra: "Este momento para m√≠ queda grabado en mi coraz√≥n. Esta canci√≥n define c√≥mo me siento cada que observo esta foto; es esencia de mi vida."
  },
  {
    id: 2,
    titulo: "Las cosas pasan por algo",
    fecha: "09/01/2026 - Una serie de acontecimientos que nos llevaron a estar juntos por √∫ltima vez",
    imagen: "imagenes/foto2.jpeg",
    descripcion: "Un d√≠a ca√≥tico en el que tu t√≠a y una se√±ora en una librer√≠a ayudaron a que nosotros nos pudi√©ramos despedir en persona y vernos por √∫ltima vez, confirmando que hab√≠amos creado un apego entre nosotros que define nuestro amor, siendo as√≠ fiel creyente que las cosas pasan por algo.",
    cancionRuta: "musica-cancion-recuerdo2.mp3",
    cancionNombre: "Me muero",
    letra: "Como la canci√≥n lo dice, me muero, y en ese momento me mor√≠a por dentro por verte una √∫ltima vez y poder verte, besarte y abrazarte una √∫ltima vez."
  },
  {
    id: 3,
    titulo: "Una cita para el recuerdo",
    fecha: "07/01/2026 - Un d√≠a que pasamos juntos en el cual se nos dio por ver cualquier pel√≠cula",
    imagen: "imagenes/foto3.jpeg",
    descripcion: "Tantas eran nuestras ganas de vernos que decidimos ver cualquier pel√≠cula con tal de poder pasar tiempo juntos, sin importar si √≠bamos a ver la pel√≠cula o no.",
    cancionRuta: "musica-cancion-recuerdo3.mp3",
    cancionNombre: "Volverte a ver",
    letra: "Como la canci√≥n lo dice, no me import√≥ lo que fuera con tal de volverte a ver una vez m√°s y poder estar contigo de nuevo."
  },
  {
    id: 4,
    titulo: "Una cita para el recuerdo",
    fecha: "07/01/2026 - Un d√≠a que pasamos juntos en el cual se nos dio por ver cualquier pel√≠cula",
    imagen: "imagenes/foto4.jpeg",
    descripcion: "Tantas eran nuestras ganas de vernos que decidimos ver cualquier pel√≠cula con tal de poder pasar tiempo juntos, sin importar si √≠bamos a ver la pel√≠cula o no.",
    cancionRuta: "musica-cancion-recuerdo4.mp3",
    cancionNombre: "Para Siempre",
    letra: "Si pudiera cambiar algo, no cambiar√≠a nada. Quiero todo una vez m√°s, pero despacio para poder disfrutar con m√°s tiempo cada momento."
  },
  {
    id: 5,
    titulo: "Una cita para el recuerdo",
    fecha: "07/01/2026 - Un d√≠a que pasamos juntos en el cual se nos dio por ver cualquier pel√≠cula",
    imagen: "imagenes/foto5.jpeg",
    descripcion: "Tantas eran nuestras ganas de vernos que decidimos ver cualquier pel√≠cula con tal de poder pasar tiempo juntos, sin importar si √≠bamos a ver la pel√≠cula o no.",
    cancionRuta: "musica-cancion-recuerdo5.mp3",
    cancionNombre: "Te Sigo Amando",
    letra: "Despu√©s de buscarte tanto tiempo, por fin estoy a tu lado, y soy feliz porque cada vez que te tengo delante tiemblo de nervios al emocionarme por verte."
  },
  {
    id: 6,
    titulo: "Una cita para el recuerdo",
    fecha: "07/01/2026 - Un d√≠a que pasamos juntos en el cual se nos dio por ver cualquier pel√≠cula",
    imagen: "imagenes/foto6.jpeg",
    descripcion: "Tantas eran nuestras ganas de vernos que decidimos ver cualquier pel√≠cula con tal de poder pasar tiempo juntos, sin importar si √≠bamos a ver la pel√≠cula o no.",
    cancionRuta: "musica-cancion-recuerdo6.mp3",
    cancionNombre: "Amor a Primera",
    letra: "Unos ojos tan perfectos y una persona tan hermosa que nunca me cansar√≠a de verla."
  },
  {
    id: 7,
    titulo: "Una cita para el recuerdo",
    fecha: "07/01/2026 - Un d√≠a que pasamos juntos en el cual se nos dio por ver cualquier pel√≠cula",
    imagen: "imagenes/foto7.jpeg",
    descripcion: "Tantas eran nuestras ganas de vernos que decidimos ver cualquier pel√≠cula con tal de poder pasar tiempo juntos, sin importar si √≠bamos a ver la pel√≠cula o no.",
    cancionRuta: "musica-cancion-recuerdo7.mp3",
    cancionNombre: "Ense√±ame a bailar",
    letra: "Como la canci√≥n lo dice, mi coraz√≥n no es de arena, pero t√∫ est√°s dejando tus huellas para que nunca se me ocurra olvidarte en otra vida."
  },
  {
    id: 8,
    titulo: "Mi recuerdo favorito",
    fecha: "05/01/2026 - Una serie de acontecimientos que nos dirigen aqu√≠, a mi momento favorito contigo",
    imagen: "imagenes/foto8.jpeg",
    descripcion: "Una serie de acontecimientos que nos dirigen aqu√≠, a mi momento favorito contigo, a darte ese beso que no hace m√°s que emocionarme cada vez que pienso en √©l, en pensar en c√≥mo te amo.",
    cancionRuta: "musica-cancion-recuerdo8.mp3",
    cancionNombre: "Te lo Estoy Afirmando",
    letra: "Como la canci√≥n lo dice, en cuesti√≥n de sentimientos me traes bien atarantado; la verdad, soy tu tonto y me traes bien ilusionado, y no, no te lo estoy contando: yo te lo estoy afirmando."
  },
  {
    id: 9,
    titulo: "T√∫ eres mi estrella",
    fecha: "09/01/2026 - Un detalle especial para demostrarte lo que t√∫ eres para m√≠",
    imagen: "imagenes/foto9.jpeg",
    descripcion: "Luego de un d√≠a muy ocupado en el cual solo me quedaba probar mi moto, ten√≠a un detalle especial para demostrarte lo que t√∫ eres para m√≠, lo que significas.",
    cancionRuta: "musica-cancion-recuerdo9.mp3",
    cancionNombre: "Un Deseo",
    letra: "No me importa c√≥mo est√©, siempre me tomar√© el tiempo de poder cruzar la ciudad entera o zafarme de donde est√© para poder verte, as√≠ sean 5 minutos, y poder ser feliz esos 5 minutos a tu lado."
  },
  {
    id: 10,
    titulo: "Una reparaci√≥n poco habitual",
    fecha: "30/12/2025 - Un momento extra√±o pero especial a nuestro estilo",
    imagen: "imagenes/foto10.jpeg",
    descripcion: "Nunca acompa√±as a nadie al taller; fue un momento para pasarlo juntos muy extra√±o, pero especial a la vez porque lo nuestro nunca es normal, siempre es extra√±o a nuestro estilo, donde solo nosotros nos entendemos.",
    cancionRuta: "musica-cancion-recuerdo10.mp3",
    cancionNombre: "Te Quiero",
    letra: "Te quiero, y no hago otra cosa m√°s que pensar en ti en cada momento que puedo; cada cosa o momento bonito me hace pensar en ti."
  },
  {
    id: 11,
    titulo: "Una reparaci√≥n poco habitual",
    fecha: "30/12/2025 - Un momento extra√±o pero especial a nuestro estilo",
    imagen: "imagenes/foto11.jpeg",
    descripcion: "Nunca acompa√±as a nadie al taller; fue un momento para pasarlo juntos muy extra√±o, pero especial a la vez porque lo nuestro nunca es normal, siempre es extra√±o a nuestro estilo, donde solo nosotros nos entendemos.",
    cancionRuta: "musica-cancion-recuerdo11.mp3",
    cancionNombre: "Di Que No Te Vas",
    letra: "Morat, no hay m√°s que decir; es algo que te gusta, y t√∫ me gustas a m√≠."
  },
  {
    id: 12,
    titulo: "Una reparaci√≥n poco habitual",
    fecha: "30/12/2025 - Un momento extra√±o pero especial a nuestro estilo",
    imagen: "imagenes/foto12.jpeg",
    descripcion: "Nunca acompa√±as a nadie al taller; fue un momento para pasarlo juntos muy extra√±o, pero especial a la vez porque lo nuestro nunca es normal, siempre es extra√±o a nuestro estilo, donde solo nosotros nos entendemos.",
    cancionRuta: "musica-cancion-recuerdo12.mp3",
    cancionNombre: "Loco",
    letra: "Me vuelvo loco de amor por tu forma de ser, por ver c√≥mo amas, c√≥mo sientes y c√≥mo vives; me enloquece de amor."
  },
  {
    id: 13,
    titulo: "Una reparaci√≥n poco habitual",
    fecha: "30/12/2025 - Un momento extra√±o pero especial a nuestro estilo",
    imagen: "imagenes/foto13.jpeg",
    descripcion: "Nunca acompa√±as a nadie al taller; fue un momento para pasarlo juntos muy extra√±o, pero especial a la vez porque lo nuestro nunca es normal, siempre es extra√±o a nuestro estilo, donde solo nosotros nos entendemos.",
    cancionRuta: "musica-cancion-recuerdo13.mp3",
    cancionNombre: "Creep",
    letra: "No hay mucho que decir, siempre me siento raro e incomprendido, pero contigo siento paz y s√© que sin decir una sola palabra sabes lo que pasa."
  },
  {
    id: 14,
    titulo: "Una reparaci√≥n poco habitual",
    fecha: "30/12/2025 - Un momento extra√±o pero especial a nuestro estilo",
    imagen: "imagenes/foto14.jpeg",
    descripcion: "Nunca acompa√±as a nadie al taller; fue un momento para pasarlo juntos muy extra√±o, pero especial a la vez porque lo nuestro nunca es normal, siempre es extra√±o a nuestro estilo, donde solo nosotros nos entendemos.",
    cancionRuta: "musica-cancion-recuerdo14.mp3",
    cancionNombre: "Luther",
    letra: "Simplemente nosotros dos siendo felices, sonriendo, pegados uno al otro."
  },
  {
    id: 15,
    titulo: "Una reparaci√≥n poco habitual",
    fecha: "30/12/2025 - Un momento extra√±o pero especial a nuestro estilo",
    imagen: "imagenes/foto15.jpeg",
    descripcion: "Nunca acompa√±as a nadie al taller; fue un momento para pasarlo juntos muy extra√±o, pero especial a la vez porque lo nuestro nunca es normal, siempre es extra√±o a nuestro estilo, donde solo nosotros nos entendemos.",
    cancionRuta: "musica-cancion-recuerdo15.mp3",
    cancionNombre: "Can't Help Falling in Love",
    letra: "No puedo evitar seguir enamor√°ndome de ti; cada vez que te veo o te pienso, ese sentimiento aumenta y eso me encanta."
  },
  {
    id: 16,
    titulo: "Tan hermosa como siempre",
    fecha: "No recuerdo jajaja - T√∫ te sigues viendo hermosa siempre",
    imagen: "imagenes/foto16.jpeg",
    descripcion: "Es imposible no hacerte saber d√≠a con d√≠a lo hermosa que t√∫ te miras siempre. Soy afortunado de poder verte y apreciar que no importa c√≥mo, t√∫ te seguir√°s viendo hermosa siempre.",
    cancionRuta: "musica-cancion-recuerdo16.mp3",
    cancionNombre: "Enamorado Tuyo",
    letra: "Y si te parece que yo estoy enamorado tuyo, eso en alg√∫n otro momento dir√≠a que es un invento tuyo; pero la realidad es que s√≠ lo estoy y me muero de amor por ti."
  },
  {
    id: 17,
    titulo: "Un cambio de peinado",
    fecha: "28/12/2025 - Una actividad por aburrimiento se convirti√≥ en un recuerdo hermoso",
    imagen: "imagenes/foto17.jpeg",
    descripcion: "Lo que para ti empez√≥ en una actividad por aburrimiento, para m√≠ se convirti√≥ en un recuerdo muy hermoso; me encant√≥ verte con rizos, te ve√≠as tan perfecta.",
    cancionRuta: "musica-cancion-recuerdo17.mp3",
    cancionNombre: "Carita Linda",
    letra: "Te miro y no puedo evitar decir lo linda que estabas con ese peinado; te mirabas tan linda que ten√≠a que presumirte."
  },
  {
    id: 18,
    titulo: "Una diferencia considerable",
    fecha: "07/01/2026 - Para el amor no existen tama√±os",
    imagen: "imagenes/foto18.jpeg",
    descripcion: "Una foto que mi pap√° quer√≠a ver; quer√≠a saber por qu√© te dec√≠an pulguita. Eso se convirti√≥ en una foto que demuestra que para el amor no existen tama√±os.",
    cancionRuta: "musica-cancion-recuerdo18.mp3",
    cancionNombre: "Es Por Ti",
    letra: "No hay mucho que agregar: nuestra √∫nica foto de cuerpo completo demostrando que las diferencias de tama√±o no importan para darte un beso."
  },
  {
    id: 19,
    titulo: "Nuestra primera cita",
    fecha: "16/12/2025 - La pel√≠cula fue mala, estar abrazados fue lo mejor",
    imagen: "imagenes/foto19.jpeg",
    descripcion: "Nuestra primera cita; qui√©n dir√≠a que terminar√≠amos viendo una pel√≠cula tan espantosa, que lo √∫nico salvable fue estar abrazados durante tanto tiempo, algo nuevo para nosotros dos.",
    cancionRuta: "musica-cancion-recuerdo19.mp3",
    cancionNombre: "Me Enamora",
    letra: "Nuestra primera cita me enamora; me enamora recordar todos esos momentos que vivimos ese d√≠a t√∫ y yo."
  },
  {
    id: 20,
    titulo: "Nuestra primera cita",
    fecha: "16/12/2025 - La pel√≠cula fue mala, estar abrazados fue lo mejor",
    imagen: "imagenes/foto20.jpeg",
    descripcion: "Nuestra primera cita; qui√©n dir√≠a que terminar√≠amos viendo una pel√≠cula tan espantosa, que lo √∫nico salvable fue estar abrazados durante tanto tiempo, algo nuevo para nosotros dos.",
    cancionRuta: "musica-cancion-recuerdo20.mp3",
    cancionNombre: "Tiroteo",
    letra: "Contigo soy tan feliz que me siento como un ni√±o en Toys R Us."
  },
  {
    id: 21,
    titulo: "Nuestra primera cita",
    fecha: "16/12/2025 - La pel√≠cula fue mala, estar abrazados fue lo mejor",
    imagen: "imagenes/foto21.jpeg",
    descripcion: "Nuestra primera cita; qui√©n dir√≠a que terminar√≠amos viendo una pel√≠cula tan espantosa, que lo √∫nico salvable fue estar abrazados durante tanto tiempo, algo nuevo para nosotros dos.",
    cancionRuta: "musica-cancion-recuerdo21.mp3",
    cancionNombre: "Hayami Hana",
    letra: "Por si alg√∫n d√≠a no recuerdas c√≥mo sonr√≠o al verte, regresa a esta foto las veces que t√∫ quieras."
  },
  {
    id: 22,
    titulo: "T√∫ y yo de nuevo juntos",
    fecha: "01/12/2025 - Nuestra primera foto luego de m√°s de dos a√±os",
    imagen: "imagenes/foto22.jpeg",
    descripcion: "Nuestra primer foto luego de algo m√°s de dos a√±os, la foto con la que todo el mundo supo que t√∫ y yo est√°bamos juntos.",
    cancionRuta: "musica-cancion-recuerdo22.mp3",
    cancionNombre: "Berl√≠n",
    letra: "La melod√≠a de esta canci√≥n describe perfectamente c√≥mo me sent√≠ yo al verte de nuevo y poder besarte; esa melod√≠a explica lo especial que fue para m√≠."
  },
  {
    id: 23,
    titulo: "Nuestra primera cita",
    fecha: "16/12/2025 - La pel√≠cula fue mala, estar abrazados fue lo mejor",
    imagen: "imagenes/foto23.jpeg",
    descripcion: "Nuestra primera cita; qui√©n dir√≠a que terminar√≠amos viendo una pel√≠cula tan espantosa, que lo √∫nico salvable fue estar abrazados durante tanto tiempo, algo nuevo para nosotros dos.",
    cancionRuta: "musica-cancion-recuerdo23.mp3",
    cancionNombre: "My Kind of Woman",
    letra: "Por si te quedan dudas, solo te amo a ti, y mi amor est√° destinado para ti por lo que a m√≠ me reste de vida."
  },
  {
    id: 24,
    titulo: "Una mirada que hipnotiza",
    fecha: "11/12/2025 - Una foto tuya que me dej√≥ hipnotizado",
    imagen: "imagenes/foto24.jpeg",
    descripcion: "Una foto que me enviaste como si nada; qui√©n me dir√≠a a m√≠ que quedar√≠a hipnotizado por esa mirada tan encantadora que t√∫ tienes.",
    cancionRuta: "musica-cancion-recuerdo24.mp3",
    cancionNombre: "Ojitos de Miel",
    letra: "Esos ojitos de miel que me vuelven loco quiero ver por el resto de mis d√≠as, hasta que mis huesos se vuelvan polvo."
  },
  {
    id: 25,
    titulo: "Juntos para siempre",
    fecha: "‚àû/‚àû/‚àû - Te quiero en mi presente y en mi futuro",
    imagen: "imagenes/foto25.jpeg",
    descripcion: "No quiero absolutamente nada que no sea contigo a tu lado; en mi futuro y en mi presente te quiero a mi lado.",
    cancionRuta: "musica-cancion-recuerdo25.mp3",
    cancionNombre: "YOKO",
    letra: "Te quiero siempre a mi ladito como Yoko, hasta que el pelo lo tenga lleno de canas. No es un secreto que t√∫ cada d√≠a me vuelves loco, y s√≠, este es el amor del cual mi abuelo me habl√≥ siempre."
  }
];

const vistaInicio = document.getElementById("vista-inicio");
const vistaCatalogo = document.getElementById("vista-catalogo");
const catalogoGrid = document.getElementById("catalogo-grid");
const buscador = document.getElementById("buscador");
const audioPrincipal = document.getElementById("audio-principal");
const audioEspecifico = document.getElementById("audio-especifico");

const modal = document.getElementById("modal-detalle");
const modalCarta = document.getElementById("modal-carta");

const modalImg = document.getElementById("modal-img");
const modalFecha = document.getElementById("modal-fecha");
const modalTitulo = document.getElementById("modal-titulo");
const modalId = document.getElementById("modal-id");
const modalDesc = document.getElementById("modal-desc");
const modalCancionNombre = document.getElementById("modal-cancion-nombre");
const modalLetra = document.getElementById("modal-letra");

const btnIniciar = document.getElementById("btn-iniciar");
const btnSorpresa = document.getElementById("btn-sorpresa");
const btnCarta = document.getElementById("btn-carta");
const btnAudio = document.getElementById("btn-audio");
const closeBtns = document.querySelectorAll(".close-btn");

let limpiarFallbackPrincipal = () => {};
let limpiarFallbackEspecifico = () => {};

function construirRutasAudio(ruta) {
  const limpio = ruta.replace(/^musica\//, "");
  const candidatas = [
    `musica/${limpio}`,
    `musica/musica-${limpio}`,
    limpio,
    `musica-${limpio}`
  ];

  return [...new Set(candidatas)];
}

function aplicarFallbackAudio(audioEl, ruta) {
  const rutas = construirRutasAudio(ruta);
  let indice = 0;

  const intentarSiguiente = () => {
    if (indice >= rutas.length) return;
    audioEl.src = rutas[indice];
    indice += 1;
    audioEl.load();
  };

  const alError = () => {
    intentarSiguiente();
  };

  audioEl.addEventListener("error", alError);
  intentarSiguiente();

  return () => audioEl.removeEventListener("error", alError);
}

function reproducirAlCargar(audioEl) {
  const alPoderReproducir = () => {
    audioEl.play().catch(() => {});
    audioEl.removeEventListener("canplay", alPoderReproducir);
  };

  audioEl.addEventListener("canplay", alPoderReproducir);
}

function renderCatalogo(listado) {
  catalogoGrid.innerHTML = "";

  listado.forEach((item) => {
    const card = document.createElement("article");
    card.className = "card";
    card.innerHTML = `
      <img src="${item.imagen}" alt="${item.titulo}" onerror="this.src='https://via.placeholder.com/600x400/171d3c/f7f8ff?text=Recuerdo+${item.id}'">
      <div class="card-body">
        <h3>${item.titulo}</h3>
        <p>${item.fecha}</p>
      </div>
    `;

    card.addEventListener("click", () => abrirDetalle(item));
    catalogoGrid.appendChild(card);
  });
}

function abrirCatalogo() {
  vistaInicio.hidden = true;
  vistaCatalogo.hidden = false;
  window.scrollTo({ top: 0, behavior: "smooth" });
  window.location.hash = "catalogo";
  renderCatalogo(baseDeDatos);
}

function abrirDetalle(item) {
  modal.classList.add("active");
  modal.setAttribute("aria-hidden", "false");

  modalImg.src = item.imagen;
  modalFecha.textContent = item.fecha;
  modalTitulo.textContent = item.titulo;
  modalId.textContent = `Recuerdo #${item.id}`;
  modalDesc.textContent = item.descripcion;
  modalCancionNombre.textContent = item.cancionNombre;
  modalLetra.textContent = item.letra;

  audioPrincipal.pause();
  limpiarFallbackEspecifico();
  limpiarFallbackEspecifico = aplicarFallbackAudio(audioEspecifico, item.cancionRuta);
  reproducirAlCargar(audioEspecifico);
}

function cerrarModales() {
  modal.classList.remove("active");
  modalCarta.classList.remove("active");
  modal.setAttribute("aria-hidden", "true");
  modalCarta.setAttribute("aria-hidden", "true");
  audioEspecifico.pause();
  audioEspecifico.currentTime = 0;
  limpiarFallbackEspecifico();
}

function manejarHash() {
  if (window.location.hash === "#catalogo") {
    abrirCatalogo();
    return;
  }

  vistaInicio.hidden = false;
  vistaCatalogo.hidden = true;
}

btnIniciar.addEventListener("click", abrirCatalogo);
btnSorpresa.addEventListener("click", () => {
  modalCarta.classList.add("active");
  modalCarta.setAttribute("aria-hidden", "false");
});
btnCarta.addEventListener("click", () => {
  modalCarta.classList.add("active");
  modalCarta.setAttribute("aria-hidden", "false");
});

btnAudio.addEventListener("click", () => {
  if (audioPrincipal.paused) {
    audioPrincipal.volume = 0.45;
    audioPrincipal.play().catch(() => {});
    btnAudio.innerHTML = '<i class="fa-solid fa-pause"></i>';
    return;
  }

  audioPrincipal.pause();
  btnAudio.innerHTML = '<i class="fa-solid fa-music"></i>';
});

closeBtns.forEach((btn) => btn.addEventListener("click", cerrarModales));

[modal, modalCarta].forEach((container) => {
  container.addEventListener("click", (event) => {
    if (event.target === container) cerrarModales();
  });
});

document.addEventListener("keydown", (event) => {
  if (event.key === "Escape") cerrarModales();
});

buscador.addEventListener("input", (event) => {
  const query = event.target.value.trim().toLowerCase();
  const filtrados = baseDeDatos.filter((item) => {
    return (
      item.titulo.toLowerCase().includes(query) ||
      item.fecha.toLowerCase().includes(query)
    );
  });

  renderCatalogo(filtrados);
});

window.addEventListener("hashchange", manejarHash);
window.addEventListener("load", () => {
  document.getElementById("total-recuerdos").textContent = String(baseDeDatos.length);
  document.getElementById("total-canciones").textContent = String(baseDeDatos.length);

  manejarHash();
  audioPrincipal.volume = 0.35;

  limpiarFallbackPrincipal();
  limpiarFallbackPrincipal = aplicarFallbackAudio(audioPrincipal, "musica/cancion-principal.mp3");
  reproducirAlCargar(audioPrincipal);

  audioPrincipal.play().then(() => {
    btnAudio.innerHTML = '<i class="fa-solid fa-pause"></i>';
  }).catch(() => {});
});

  </script>
</body>
</html>